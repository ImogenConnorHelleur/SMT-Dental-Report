---
title: "Dental Data Pack"
subtitle: "National"
date: "`r paste(format(Sys.time(), '%B, %Y'), ' - Reporting up to end of', format(Sys.Date() - lubridate::weeks(4), '%B, %Y'))`"
output:
  xaringan::moon_reader:
    css: [theme.css, nhsr-fonts.css]
    self_contained: true
    lib_dir: libs
    nature:
      ratio: '16:9'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---


```{r setup, include=FALSE}

library(tidyverse)
library(readxl)
library(DBI)
library(odbc)
library(reactable) #make sure you have the latest version by doing install.packages("reactable")
library(downloadthis)
library(lubridate)

#source in all file from plot folder
for (f in list.files(path = "../R/03 plot_functions/", pattern="*.R$")) {
    source(paste0("../R/03 plot_functions/", f))
}

for (f in list.files(path = "../R/02 format_data_functions/", pattern="*.R$")) {
    source(paste0("../R/02 format_data_functions/", f))
}


#pull data from NCDR
UDA_calendar_data <- pull_UDA_calendar_data()
UOA_calendar_data <- pull_UOA_calendar_data()
UDA_scheduled_data <- pull_UDA_scheduled_data()
UOA_scheduled_data <- pull_UOA_scheduled_data()
payments_to_dentists <- pull_payments_to_dentist()

historical_UDA_scheduled_data <- pull_UDA_scheduled_historical_data()
historical_UDA_scheduled_data <- rename(historical_UDA_scheduled_data, month = data_month)

historical_UOA_scheduled_data <- pull_UOA_scheduled_historical_data()
historical_UOA_scheduled_data <- rename(historical_UOA_scheduled_data, month = data_month)

#change column names and add regions
UDA_calendar_data <- rename(UDA_calendar_data, month = data_month)
UOA_calendar_data <- UOA_calendar_data %>%
  rename(month = data_month) %>%
  mutate(contract_number = as.numeric(contract_number),
         UOA_total = as.numeric(UOA_total))

    
# UOA_calendar_data <- left_join( region_STP_lookup, by = c("contract_number", "name_or_company_name", "commissioner_name"))
UDA_scheduled_data <- rename(UDA_scheduled_data, month = data_month)
UOA_scheduled_data <- rename(UOA_scheduled_data, month = data_month)

UDA_scheduled_data <- mutate(UDA_scheduled_data, month = as.Date(month))
UOA_scheduled_data <- mutate(UOA_scheduled_data, month = as.Date(month))

#sort out STP ICB changes
STP_ICB_lookup_codes <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/STP_ICB_lookup_codes.xlsx")

#Read local 111 file
dental_data_111 <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/111_pathways_data/dental_data_111.xlsx")

#############still to fix
prototype_contracts <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/prototype_contracts.xlsx")
contractor_categories <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/contractor_categories_Jan23.xlsx")
contractor_categories <- contractor_categories %>%
  mutate(contract_number = as.numeric(contract_number))
contract_demographics <- readRDS("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/contract_demographics.rds")

#read in unique patients
#unique_patients_rolling <- readRDS("../data/unique_patients/unique_patients_rolling.rds")
unique_patients_rolling <- pull_unique_patients_data()

#read in recalls 
dental_recalls_STP_2018_22 <- readRDS("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/dental_recalls_STP_2018_22.rds")

#read in CDS data
CDS_data <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/CDS/CDS_data.xlsx")
CDS_data <- clean_CDS_data_colnames(CDS_data)

#read in hand backs data
contract_handbacks <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/contract_handbacks.xlsx")

#read in and clean complaints data
Dental_Access_Complaints_Data_June_22 <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/complaints/Dental Access Complaints Data June 22.xlsx")
dental_complaints <- clean_complaints_data(Dental_Access_Complaints_Data_June_22)

#UDA value data
UDA_values <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/UDA_values.xlsx")
UDA_UOA_value_data <- pull_UDA_UOA_value()

#Pull patient charge data
patient_exemption_data <- pull_patient_exemption_data()
patient_exemption_data <- clean_patient_exemption_data()

#pull health inequalities data
health_inequalities_data <- pull_health_inequalities()

missing_contracts_data <- read_excel("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/data_for_monthly_report/missing_contract_details.xlsx")

#DCP_data <- read.csv("N:/_Everyone/Primary Care Group/SMT_Dental DENT 2022_23-008/DCP_data/DPC_v1_Oct_2022.csv") 
DCP_data <- pull_dcp_data()

BPE_data <- pull_BPE_data()

band2_split_data <- pull_band2_split_data()

new_vs_return_data <- pull_new_vs_returning_patients()

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

#avoid standard form
options(scipen=999)

# Suppress summarise info
options(dplyr.summarise.inform = FALSE)

```


name: contents
#### Contents 1 

 <font size="2">
#### Dental
 * [Table of number of contracts by MY category](#contracts-table)
 * [UDA activity](#short-uda-activity)
 * [UDA activity by MY category](#short-uda-activity-my-cat)
 * [Cumulative UDA delivery per quarter](#cumulative-udas)
 * [YTD UDA delivery](#YTD-udas)
 * [Historic UDA delivery](#historic-udas)
 * [Contract size vs delivery scatter plot](#contract-size-scatter)
 * [UDA delivery profile across months](#uda-delivery-profile)
 * [Banded courses of treatment time series](#banded-cots)
 * [Banded courses of treatment time series as % of 2019 delivery](#banded-cots-index)
 * [Urgent treatment form submissions](#urgent-forms)
 * [Percentage of FP17s in each band 2 sub-category](#band2-split-FP17-perc)
 * [UDAs delivered by patient charge status](#patient-charge)
 * [Contractors projected to deliver at least 96% of contracted UDAs](#UDA-projection)
 * [Percentage of CoTs assisted by Dental Care Practitioners (DCPs)](#dcp-fp17)
 * [Percentage of UDAs assisted by Dental Care Practitioners (DCPs) by band](#dcp-uda)
 * [Percentage of FP17s indicating low oral health risk](#bpe)
 * [111 call volumes](#111-call-volumes)
 * [Unique patients seen rolling 12 months](#unique-patients)
 * [Unique patients seen rolling 12 months as % of April 2018 delivery](#unique-patients-index)
 * [Number of new patients](#new-patients)
 * [Percentage of practices seeing new patients](#new-patients-perc)
 * [Patient re-attendance intervals](#reattendance)
 * [Community Dental Services (CDS) Patients waiting for assessment](#cds)
 * [CDS Patients waiting for treatment](#cds-treatment)
 * [CDS Patients waiting for assessment](#cds-wait-weeks-assessment)
 * [CDS Patients waiting for treatment](#cds-wait-weeks-treatment)
 * [Contract closures based on PCAR report](#closures)
 * [De-commissioned and re-commissioned UDAs and UOAs as a result of closure based on PCAR](#de-and-re-commissioned)
 * [Total annual contracted UDAs trend](#annual-contracted-UDAs-trend)
 * [Total number of contracts trend](#num-contracts-trend)
 * [Total payments to dentists by financial year](#payemts)
 * [Cumulative financial value of UDAs delivered YTD](#uda-value)


---

name: contents
#### Contents 2

 <font size="2">
#### Orthodontic 
 * [UOA activity](#uoa-activity)
 * [UOA activity by MY category](#uoa-activity-my-cat)
 * [Cumulative UOA delivery per quarter](#cumulative-uoas)
 * [YTD UOA delivery](#YTD-uoas)
 * [UOA delivery profile across months](#uoa-delivery-profile)
 
#### Appendix
 * [MY Category classification breakdown](#my-cat-breakdown)
 * [Data sources](#data-sources)
 

<font size="1">
#### NOTE 
This is an interactive markdown report.  You can navigate from slide to slide by either clicking the mouse on the screen or by using the cursor keys.  **Press ? for help.** Some pages have selection buttons across regions, click on the region in order to explore the data for that area.  

---

### Calendar and scheduled data

All analyses in this report now only use **scheduled data**. 

<font size="2">
#### Calendar data explanation

* Calendar data is based on courses of treatment completed within an entire month, for example 1st February to 28th Feb
* For calendar data, if a COT was completed in February but not declared till March, that activity would still be registered as
occurring in February.
* This means that graphs using calendar data may change for historical months as more COTs are registered.
* The activity % is now based on total number of UDA/UOAs delivered as a % of total contracted UDA/UOAs per quarter.


#### Scheduled data explanation
* The scheduling time period is usually between the 20th of one month and the 20th of the next month i.e., 21st April to the
19th May. That means that any Mandatory contract COT completed after this period will not be included in the May
scheduled data. However, if for example a COT was completed on May 1st, but reported to the BSA after the end of the
reporting period (April 21st â€“ May 19th), that activity would go into the following scheduled period. As a result, the
scheduling period can be considered fixed.
* N.B. Scheduled data for April is from 1st April - 21st April. This has been taken into account when scaling up to annual delivery.

---
name: contracts-table

```{css, echo=F}
    /* Table width = 100% max-width */

    .remark-slide table{
        width: 100%;
    }

    /* Change the background color to white for shaded rows (even rows) */

    .remark-slide thead, .remark-slide tr:nth-child(2n) {
        background-color: white;
    }
```

### Number of contracts by Mid-Year (MY) category
(see appendix for category descriptions)

```{r xaringan-panelset-contracts, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]

#### Including contracts with annual contracted UDA < 100
```{r table11, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = F, level = "National", region_STP_name = NULL), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

#### Excluding contracts with annual contracted UDA < 100
```{r table21, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = T, level = "National", region_STP_name = NULL), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```


]
.panel[.panel-name[South East]

#### Including contracts with annual contracted UDA < 100
```{r table12, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = F, level = "Regional", region_STP_name = "South East"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

#### Excluding contracts with annual contracted UDA < 100
```{r table22, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = T, level = "Regional", region_STP_name = "South East"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```



]
.panel[.panel-name[South West]

#### Including contracts with annual contracted UDA < 100
```{r table13, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = F, level = "Regional", region_STP_name = "South West"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

#### Excluding contracts with annual contracted UDA < 100
```{r table23, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = T, level = "Regional", region_STP_name = "South West"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```



]
.panel[.panel-name[North West]

#### Including contracts with annual contracted UDA < 100
```{r table14, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = F, level = "Regional", region_STP_name = "North West"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

#### Excluding contracts with annual contracted UDA < 100
```{r table24, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = T, level = "Regional", region_STP_name = "North West"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```



]
.panel[.panel-name[North East and Yorkshire]

#### Including contracts with annual contracted UDA < 100
```{r table15, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = F, level = "Regional", region_STP_name = "North East and Yorkshire"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

#### Excluding contracts with annual contracted UDA < 100
```{r table25, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = T, level = "Regional", region_STP_name = "North East and Yorkshire"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```



]
.panel[.panel-name[London]

#### Including contracts with annual contracted UDA < 100
```{r table16, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = F, level = "Regional", region_STP_name = "London"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

#### Excluding contracts with annual contracted UDA < 100
```{r table26, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = T, level = "Regional", region_STP_name = "London"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```


]
.panel[.panel-name[Midlands]

#### Including contracts with annual contracted UDA < 100
```{r table17, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = F, level = "Regional", region_STP_name = "Midlands"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

#### Excluding contracts with annual contracted UDA < 100
```{r table27, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = T, level = "Regional", region_STP_name = "Midlands"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```



]
.panel[.panel-name[East of England]

#### Including contracts with annual contracted UDA < 100
```{r table18, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = F, level = "Regional", region_STP_name = "East of England"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```

#### Excluding contracts with annual contracted UDA < 100
```{r table28, echo = FALSE, warning = FALSE, message = FALSE}
knitr::kable(table_number_cat_contracts(remove_prototypes = T, level = "Regional", region_STP_name = "East of England"), format = 'html') %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```



]
]

"Category not known" is mostly made up of new contracts which have not yet been assigned a category as of the last Mid Year update. 

[Return to contents](#contents)

---

name: short-uda-activity

### UDA Activity Data

```{r xaringan-panelset-UDA-activity, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]
```{r UDA_activity_Calendar1, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE)
```

* This graph shows the average monthly performance of the **`r get_num_contracts(level = "National", region_STP_name = NULL)`** GDS/PDS/PDS+ contracts scaled up by 12 months measured against the delivery thresholds (60% for Apr-Sep 21, 65% for Oct-Dec, 85% for Jan-Mar, 95% for Apr-Jun 22 and 100% going forward).


]
.panel[.panel-name[South East]
```{r UDA_activity_Calendar2, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "South East")
```

* This graph shows the average monthly performance of the **`r get_num_contracts(level = "Regional", region_STP_name = "South East")`** GDS/PDS/PDS+ contracts scaled up by 12 months measured against the delivery thresholds (60% for Apr-Sep 21, 65% for Oct-Dec, 85% for Jan-Mar, 95% for Apr-Jun 22 and 100% going forward).


]
.panel[.panel-name[South West]
```{r UDA_activity_Calendar3, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "South West")
```

* This graph shows the average monthly performance of the **`r get_num_contracts(level = "Regional", region_STP_name = "South West")`** GDS/PDS/PDS+ contracts scaled up by 12 months measured against the delivery thresholds (60% for Apr-Sep 21, 65% for Oct-Dec, 85% for Jan-Mar, 95% for Apr-Jun 22 and 100% going forward).


]
.panel[.panel-name[North West]
```{r UDA_activity_Calendar4, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "North West")
```

* This graph shows the average monthly performance of the **`r get_num_contracts(level = "Regional", region_STP_name = "North West")`** GDS/PDS/PDS+ contracts scaled up by 12 months measured against the delivery thresholds (60% for Apr-Sep 21, 65% for Oct-Dec, 85% for Jan-Mar, 95% for Apr-Jun 22 and 100% going forward).


]
.panel[.panel-name[North East and Yorkshire]
```{r UDA_activity_Calendar5, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```

* This graph shows the average monthly performance of the **`r get_num_contracts(level = "Regional", region_STP_name = "North East and Yorkshire")`** GDS/PDS/PDS+ contracts scaled up by 12 months measured against the delivery thresholds (60% for Apr-Sep 21, 65% for Oct-Dec, 85% for Jan-Mar, 95% for Apr-Jun 22 and 100% going forward).


]
.panel[.panel-name[London]
```{r UDA_activity_Calendar6, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "London")
```

* This graph shows the average monthly performance of the **`r get_num_contracts(level = "Regional", region_STP_name = "London")`** GDS/PDS/PDS+ contracts scaled up by 12 months measured against the delivery thresholds (60% for Apr-Sep 21, 65% for Oct-Dec, 85% for Jan-Mar, 95% for Apr-Jun 22 and 100% going forward).


]
.panel[.panel-name[Midlands]
```{r UDA_activity_Calendar7, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```

* This graph shows the average monthly performance of the **`r get_num_contracts(level = "Regional", region_STP_name = "Midlands")`** GDS/PDS/PDS+ contracts scaled up by 12 months measured against the delivery thresholds (60% for Apr-Sep 21, 65% for Oct-Dec, 85% for Jan-Mar, 95% for Apr-Jun 22 and 100% going forward).


]
.panel[.panel-name[East of England]
```{r UDA_activity_Calendar8, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Region",
                                  region_STP_name = "East of England")
```

* This graph shows the average monthly performance of the **`r get_num_contracts(level = "Regional", region_STP_name = "East of England")`** GDS/PDS/PDS+ contracts scaled up by 12 months measured against the delivery thresholds (60% for Apr-Sep 21, 65% for Oct-Dec, 85% for Jan-Mar, 95% for Apr-Jun 22 and 100% going forward).

]
.panel[.panel-name[All]
```{r UDA_activity_Calendar9, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_UDA_UOA_delivery_all_regions(data = UDA_scheduled_data, 
                                              
                                              historic_data = historical_UDA_scheduled_data,
                                              UDAorUOA = "UDA",
                                              level = "National",
                                              region_STP_name = NULL,
                                              remove_prototypes = TRUE, 
                                              plotChart = TRUE, 
                                              all_regions_and_STPs = FALSE,
                                   include_historic = F)
```

]
.panel[.panel-name[Data]

<font size="2">
Full scheduled delivery data back to 2016 can be found on [slide 10](#historic-udas).
]
]

[Return to contents](#contents)

---

name: short-uda-activity-my-cat

### UDA activity data by MY Category
#### Prototypes and contracts with annual contracted UDAs < 100 included

```{r xaringan-panelset-UDA-activity-My-CAT, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = T)
```

]
.panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "South East",
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = T)
```


]
.panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "South West",
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = T)
```


]
.panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "North West",
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = T)
```


]
.panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire",
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = T)
```


]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "London",
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = T)
```


]
.panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "Midlands",
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = T)
```


]
.panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "East of England",
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = T)
```


]
.panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = F)

data %>%
  download_this(
    output_name = "UDA_delivery_calendar_by_MY_category_incl_prototypes_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_UDA_UOA_delivery_MY_cat(
                             data = UDA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = F),
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month"),
  columns = list(
    `Monthly UDAs delivered`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Annual contracted UDAs` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Scaled monthly UDAs delivered` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)#,
    #`Scaled percentage of UDAs delivered` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```
]
]

[Return to contents](#contents)

---

name: cumulative-udas

### UDA cumulative activity data

```{r xaringan-panelset-UDA_cumulative_activity, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL)
```

* This graph shows the cumulative activity by quarter of the
**`r get_num_contracts(level = "National", region_STP_name = NULL)`**
GDS/PDS/PDS+
contracts measured against the expected monthly total activity to achieve the quarterly thresholds (100% for Jan-Mar 23).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(level = "National", region_STP_name = NULL)`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(level = "National", region_STP_name = NULL)*100/get_num_contracts(level = "National", region_STP_name = NULL))` %**
) have delivered the required UDAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.

]
.panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "South East")
```

* This graph shows the cumulative activity by quarter of the
**`r get_num_contracts(level = "Regional", region_STP_name = "South East")`**
GDS/PDS/PDS+
contracts measured against the expected monthly total activity to achieve the quarterly thresholds (100% for Jan-Mar 23).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "South East")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "South East")*100/get_num_contracts(level = "Regional", region_STP_name = "South East"))` %**
) have delivered the required UDAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


]
.panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "South West")
```

* This graph shows the cumulative activity by quarter of the
**`r get_num_contracts(level = "Regional", region_STP_name = "South West")`**
GDS/PDS/PDS+
contracts measured against the expected monthly total activity to achieve the quarterly thresholds (100% for Jan-Mar 23).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "South West")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "South West")*100/get_num_contracts(level = "Regional", region_STP_name = "South West"))` %**
) have delivered the required UDAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


]
.panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "North West")
```

* This graph shows the cumulative activity by quarter of the
**`r get_num_contracts(level = "Regional", region_STP_name = "North West")`**
GDS/PDS/PDS+
contracts measured against the expected monthly total activity to achieve the quarterly thresholds (100% for Jan-Mar 23).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "North West")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "North West")*100/get_num_contracts(level = "Regional", region_STP_name = "North West"))` %**
) have delivered the required UDAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


]
.panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```

* This graph shows the cumulative activity by quarter of the
**`r get_num_contracts(level = "Regional", region_STP_name = "North East and Yorkshire")`**
GDS/PDS/PDS+
contracts measured against the expected monthly total activity to achieve the quarterly thresholds (100% for Jan-Mar 23).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "North East and Yorkshire")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "North East and Yorkshire")*100/get_num_contracts(level = "Regional", region_STP_name = "North East and Yorkshire"))` %**
) have delivered the required UDAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "London")
```

* This graph shows the cumulative activity by quarter of the
**`r get_num_contracts(level = "Regional", region_STP_name = "London")`**
GDS/PDS/PDS+
contracts measured against the expected monthly total activity to achieve the quarterly thresholds (100% for Jan-Mar 23).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "London")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "London")*100/get_num_contracts(level = "Regional", region_STP_name = "London"))` %**
) have delivered the required UDAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.

]
.panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```

* This graph shows the cumulative activity by quarter of the
**`r get_num_contracts(level = "Regional", region_STP_name = "Midlands")`**
GDS/PDS/PDS+
contracts measured against the expected monthly total activity to achieve the quarterly thresholds (100% for Jan-Mar 23).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "Midlands")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "Midlands")*100/get_num_contracts(level = "Regional", region_STP_name = "Midlands"))` %**
) have delivered the required UDAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


]
.panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "East of England")
```

* This graph shows the cumulative activity by quarter of the
**`r get_num_contracts(level = "Regional", region_STP_name = "East of England")`**
GDS/PDS/PDS+
contracts measured against the expected monthly total activity to achieve the quarterly thresholds (100% for Jan-Mar 23).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "East of England")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(level = "Regional", region_STP_name = "East of England")*100/get_num_contracts(level = "Regional", region_STP_name = "East of England"))` %**
) have delivered the required UDAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


]
.panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  plotChart = F,
                                  all_regions_and_STPs = T)

data %>%
  download_this(
    output_name = "cumulative_UDA_delivery_calendar_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_cumulative_UDA_UOA_to_target(data = UDA_scheduled_data,
                                  
                                  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  plotChart = F,
                                  all_regions_and_STPs = T),
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month", "Region Name"),
  columns = list(
    `Monthly UDAs delivered`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Quarterly contracted UDAs` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Montly percentage of quarterly contracted UDAs` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)#,
    #`Cumulative percentage of quarterly contracted UDAs` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```
]
]

[Return to contents](#contents)

---

name: YTD-udas

### YTD UDA delivery

```{r xaringan-panelset-UDA-activity_YTD, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE)
```


]
.panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "South East")
```


]
.panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "South West")
```


]
.panel[.panel-name[North West]
```{r  echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "North West")
```


]
.panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```


]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "London")
```


]
.panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```


]
.panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Region",
                                  region_STP_name = "East of England")
```


]
.panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = FALSE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Region",
                                  region_STP_name = "East of England")

data %>%
  download_this(
    output_name = "YTD_UDA_delivery_calendar_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_YTD_UDA_UOA_delivery(data = UDA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UDA",
                                  remove_prototypes = TRUE, 
                                  plotChart = FALSE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Region",
                                  region_STP_name = "East of England"),
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE
  
)
```
]
]

[Return to contents](#contents)

---

name: historic-udas

### Historic UDA delivery

```{r xaringan-panelset-UDA_activity_scheduled, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL)
```

* This graph shows the monthly percentage of usual annual contracted UDAs scaled up to 12 months (18 months for April) submitted. The graph uses scheduled data to measure the
activity which is fixed. This may be thought of as "UDAs submitted" in each month rather than delivered.

]
.panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "South East")
```

* This graph shows the monthly percentage of usual annual contracted UDAs scaled up to 12 months (18 months for April) submitted. The graph uses scheduled data to measure the
activity which is fixed. This may be thought of as "UDAs submitted" in each month rather than delivered.


]
.panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "South West")
```

* This graph shows the monthly percentage of usual annual contracted UDAs scaled up to 12 months (18 months for April) submitted. The graph uses scheduled data to measure the
activity which is fixed. This may be thought of as "UDAs submitted" in each month rather than delivered.


]
.panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "North West")
```

* This graph shows the monthly percentage of usual annual contracted UDAs scaled up to 12 months (18 months for April) submitted. The graph uses scheduled data to measure the
activity which is fixed. This may be thought of as "UDAs submitted" in each month rather than delivered.


]
.panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```

* This graph shows the monthly percentage of usual annual contracted UDAs scaled up to 12 months (18 months for April) submitted. The graph uses scheduled data to measure the
activity which is fixed. This may be thought of as "UDAs submitted" in each month rather than delivered.


]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "London")
```

* This graph shows the monthly percentage of usual annual contracted UDAs scaled up to 12 months (18 months for April) submitted. The graph uses scheduled data to measure the
activity which is fixed. This may be thought of as "UDAs submitted" in each month rather than delivered.

]
.panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```

* This graph shows the monthly percentage of usual annual contracted UDAs scaled up to 12 months (18 months for April) submitted. The graph uses scheduled data to measure the
activity which is fixed. This may be thought of as "UDAs submitted" in each month rather than delivered.


]
.panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "Regional",
                                  region_STP_name = "East of England")
```

* This graph shows the monthly percentage of usual annual contracted UDAs scaled up to 12 months (18 months for April) submitted. The graph uses scheduled data to measure the
activity which is fixed. This may be thought of as "UDAs submitted" in each month rather than delivered.


]
.panel[.panel-name[All]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_all_regions()
```

]
.panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  plotChart = F,
                              all_regions_and_STPs = T)

data %>%
  download_this(
    output_name = "UDA_delivery_scheduled_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_UDA_UOA_delivery(data = UDA_scheduled_data,  UDAorUOA = "UDA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  plotChart = F,
                              all_regions_and_STPs = T),
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Schedule month", "Region Name"),
  columns = list(
    `Monthly UDAs delivered`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Annual contracted UDAs` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Scaled monthly UDAs delivered` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)#,
    #`Scaled monthly percentage of contracted UDAs delivered` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```
]
]

[Return to contents](#contents)

---

name: contract-size-scatter

### Contract size to delivery comparison

```{r xaringan-panelset-contract_size, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_delivery_vs_contract_size_scatter_corporate(data = UDA_scheduled_data,
                                                 demographics_data = contract_demographics,
                                                 remove_prototypes = T,
                                                 plot_month = NULL,
                                                 UDAorUOA = "UDA",
                                                 level = "National",
                                                 region_STP_name = NULL)
```

* The scatter plot shows the relationship between contract size and delivery for the current month.
* The number of contracts delivering above 95% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "National", region_STP_name = NULL, get_num_above = 95)[1]`**
(
**`r round(as.numeric(plot_delivery_vs_contract_size_scatter_corporate(level = "National", region_STP_name = NULL, get_num_above = 95)[1]) *100 / get_num_contracts(level = "National", region_STP_name = NULL))`**
% of contracts),
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "National", region_STP_name = NULL, get_num_above = 95)[2]`**
UDAs.
* The number of contracts delivering above 100% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "National", region_STP_name = NULL, get_num_above = 100)[1]`**,
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "National", region_STP_name = NULL, get_num_above = 100)[2]`**
UDAs.

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_delivery_vs_contract_size_scatter_corporate(data = UDA_scheduled_data,
                                                 demographics_data = contract_demographics,
                                                 remove_prototypes = T,
                                                 plot_month = NULL,
                                                 UDAorUOA = "UDA",
                                                 level = "Regional",
                                                 region_STP_name = "South East")
```

* The scatter plot shows the relationship between contract size and delivery for the current month.
* The number of contracts delivering above 95% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South East", get_num_above = 95)[1]`**
(
**`r round(as.numeric(plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South East", get_num_above = 95)[1]) *100 / get_num_contracts(level = "Regional", region_STP_name = "South East"))`**
% of contracts),
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South East", get_num_above = 95)[2]`**
UDAs.
* The number of contracts delivering above 100% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South East", get_num_above = 100)[1]`**,
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South East", get_num_above = 100)[2]`**
UDAs.


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_delivery_vs_contract_size_scatter_corporate(data = UDA_scheduled_data,
                                                 demographics_data = contract_demographics,
                                                 remove_prototypes = T,
                                                 plot_month = NULL,
                                                 UDAorUOA = "UDA",
                                                 level = "Regional",
                                                 region_STP_name = "South West")
```

* The scatter plot shows the relationship between contract size and delivery for the current month.
* The number of contracts delivering above 95% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South West", get_num_above = 95)[1]`**
(
**`r round(as.numeric(plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South West", get_num_above = 95)[1]) *100 / get_num_contracts(level = "Regional", region_STP_name = "South West"))`**
% of contracts),
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South West", get_num_above = 95)[2]`**
UDAs.
* The number of contracts delivering above 100% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South West", get_num_above = 100)[1]`**,
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "South West", get_num_above = 100)[2]`**
UDAs.


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_delivery_vs_contract_size_scatter_corporate(data = UDA_scheduled_data,
                                                 demographics_data = contract_demographics,
                                                 remove_prototypes = T,
                                                 plot_month = NULL,
                                                 UDAorUOA = "UDA",
                                                 level = "Regional",
                                                 region_STP_name = "North West")
```

* The scatter plot shows the relationship between contract size and delivery for the current month.
* The number of contracts delivering above 95% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North West", get_num_above = 95)[1]`**
(
**`r round(as.numeric(plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North West", get_num_above = 95)[1]) *100 / get_num_contracts(level = "Regional", region_STP_name = "North West"))`**
% of contracts),
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North West", get_num_above = 95)[2]`**
UDAs.
* The number of contracts delivering above 100% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North West", get_num_above = 100)[1]`**,
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North West", get_num_above = 100)[2]`**
UDAs.


 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_delivery_vs_contract_size_scatter_corporate(data = UDA_scheduled_data,
                                                 demographics_data = contract_demographics,
                                                 remove_prototypes = T,
                                                 plot_month = NULL,
                                                 UDAorUOA = "UDA",
                                                 level = "Regional",
                                                 region_STP_name = "North East and Yorkshire")
```

* The scatter plot shows the relationship between contract size and delivery for the current month.
* The number of contracts delivering above 95% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North East and Yorkshire", get_num_above = 95)[1]`**
(
**`r round(as.numeric(plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North East and Yorkshire", get_num_above = 95)[1]) *100 / get_num_contracts(level = "Regional", region_STP_name = "North East and Yorkshire"))`**
% of contracts),
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North East and Yorkshire", get_num_above = 95)[2]`**
UDAs.
* The number of contracts delivering above 100% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North East and Yorkshire", get_num_above = 100)[1]`**,
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "North East and Yorkshire", get_num_above = 100)[2]`**
UDAs.


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_delivery_vs_contract_size_scatter_corporate(data = UDA_scheduled_data,
                                                 demographics_data = contract_demographics,
                                                 remove_prototypes = T,
                                                 plot_month = NULL,
                                                 UDAorUOA = "UDA",
                                                 level = "Regional",
                                                 region_STP_name = "London")
```

* The scatter plot shows the relationship between contract size and delivery for the current month.
* The number of contracts delivering above 95% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "London", get_num_above = 95)[1]`**
(
**`r round(as.numeric(plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "London", get_num_above = 95)[1]) *100 / get_num_contracts(level = "Regional", region_STP_name = "London"))`**
% of contracts),
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "London", get_num_above = 95)[2]`**
UDAs.
* The number of contracts delivering above 100% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "London", get_num_above = 100)[1]`**,
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "London", get_num_above = 100)[2]`**
UDAs.

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_delivery_vs_contract_size_scatter_corporate(data = UDA_scheduled_data,
                                                 demographics_data = contract_demographics,
                                                 remove_prototypes = T,
                                                 plot_month = NULL,
                                                 UDAorUOA = "UDA",
                                                 level = "Regional",
                                                 region_STP_name = "Midlands")
```

* The scatter plot shows the relationship between contract size and delivery for the current month.
* The number of contracts delivering above 95% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "Midlands", get_num_above = 95)[1]`**
(
**`r round(as.numeric(plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "Midlands", get_num_above = 95)[1]) *100 / get_num_contracts(level = "Regional", region_STP_name = "Midlands"))`**
% of contracts),
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "Midlands", get_num_above = 95)[2]`**
UDAs.
* The number of contracts delivering above 100% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "Midlands", get_num_above = 100)[1]`**,
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "Midlands", get_num_above = 100)[2]`**
UDAs.


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_delivery_vs_contract_size_scatter_corporate(data = UDA_scheduled_data,
                                                 demographics_data = contract_demographics,
                                                 remove_prototypes = T,
                                                 plot_month = NULL,
                                                 UDAorUOA = "UDA",
                                                 level = "Regional",
                                                 region_STP_name = "East of England")
```

* The scatter plot shows the relationship between contract size and delivery for the current month.
* The number of contracts delivering above 95% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "East of England", get_num_above = 95)[1]`**
(
**`r round(as.numeric(plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "East of England", get_num_above = 95)[1]) *100 / get_num_contracts(level = "Regional", region_STP_name = "East of England"))`**
% of contracts),
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "East of England", get_num_above = 95)[2]`**
UDAs.
* The number of contracts delivering above 100% contracted value for this month is
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "East of England", get_num_above = 100)[1]`**,
with a mean contract size of
**`r plot_delivery_vs_contract_size_scatter_corporate(level = "Regional", region_STP_name = "East of England", get_num_above = 100)[2]`**
UDAs.


 ]
 ]

[Return to contents](#contents)

---

name: uda-delivery-profile

### UDA delivery profile

```{r xaringan-panelset-UDA_delivery_profile, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "National",
                          region_STP_name = NULL,
                          include_historic = FALSE)
```

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "Regional",
                          region_STP_name = "South East",
                          include_historic = FALSE)
```


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "Regional",
                          region_STP_name = "South West",
                          include_historic = FALSE)
```



 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "Regional",
                          region_STP_name = "North West",
                          include_historic = FALSE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "Regional",
                          region_STP_name = "North East and Yorkshire",
                          include_historic = FALSE)
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "Regional",
                          region_STP_name = "London",
                          include_historic = FALSE)
```

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "Regional",
                          region_STP_name = "Midlands",
                          include_historic = FALSE)
```

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "Regional",
                          region_STP_name = "East of England",
                          include_historic = FALSE)
```

 ]
 .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "National",
                          region_STP_name = NULL,
                          plotChart = F,
                          all_regions_and_STPs = T)

data %>%
  download_this(
    output_name = "UDA_delivery_profile_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_UDA_UOA_delivery_profile(data = UDA_scheduled_data,
                          
                          UDAorUOA = "UDA",
                          level = "National",
                          region_STP_name = NULL,
                          plotChart = F,
                          all_regions_and_STPs = T),
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month", "Performance band", "Region Name"),
  columns = list(
    `Total number of contracts`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Number of contracts in performance band` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)#,
    #`Percentage of contracts in performance band` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```
 ]
 ]
 
 This graph shows the proportion of practices delivering
between a certain % group of contracted UDA activity if performance for that
month is annualised. Improvement would be seen as the distribution moving towards the right, as more contracts deliver closer to 100% of their contracted UDAs.

[Return to contents](#contents)

---

name: uoa-activity

### UOA activity data


```{r xaringan-panelset-UOA_activity, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE)
```

* This graph shows the average monthly performance of the
**`r get_num_contracts(data = UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "National", region_STP_name = NULL)`**
GDS/PDS contracts scaled up by 12 months measured against the delivery thresholds (80% for Apr-Sep 21, 85% for Oct-Dec, 90% for Jan-Mar, 100% for Apr-Jun 22).

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "South East")
```

* This graph shows the average monthly performance of the
**`r get_num_contracts(data = UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "South East")`**
GDS/PDS contracts scaled up by 12 months measured against the delivery thresholds (80% for Apr-Sep 21, 85% for Oct-Dec, 90% for Jan-Mar, 100% for Apr-Jun 22).


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "South West")
```

* This graph shows the average monthly performance of the
**`r get_num_contracts(data = UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "South West")`**
GDS/PDS contracts scaled up by 12 months measured against the delivery thresholds (80% for Apr-Sep 21, 85% for Oct-Dec, 90% for Jan-Mar, 100% for Apr-Jun 22).


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "North West")
```

* This graph shows the average monthly performance of the
**`r get_num_contracts(data = UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "North West")`**
GDS/PDS contracts scaled up by 12 months measured against the delivery thresholds (80% for Apr-Sep 21, 85% for Oct-Dec, 90% for Jan-Mar, 100% for Apr-Jun 22).


 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```

* This graph shows the average monthly performance of the
**`r get_num_contracts(data = UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "North East and Yorkshire")`**
GDS/PDS contracts scaled up by 12 months measured against the delivery thresholds (80% for Apr-Sep 21, 85% for Oct-Dec, 90% for Jan-Mar, 100% for Apr-Jun 22).

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "London")
```

* This graph shows the average monthly performance of the
**`r get_num_contracts(data = UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "London")`**
GDS/PDS contracts scaled up by 12 months measured against the delivery thresholds (80% for Apr-Sep 21, 85% for Oct-Dec, 90% for Jan-Mar, 100% for Apr-Jun 22).

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```

* This graph shows the average monthly performance of the
**`r get_num_contracts(data = UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "Midlands")`**
GDS/PDS contracts scaled up by 12 months measured against the delivery thresholds (80% for Apr-Sep 21, 85% for Oct-Dec, 90% for Jan-Mar, 100% for Apr-Jun 22).


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  historic_data = historical_UDA_scheduled_data,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  include_historic = FALSE,
                                  level = "Regional",
                                  region_STP_name = "East of England")
```

* This graph shows the average monthly performance of the
**`r get_num_contracts(data = UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "East of England")`**
GDS/PDS contracts scaled up by 12 months measured against the delivery thresholds (80% for Apr-Sep 21, 85% for Oct-Dec, 90% for Jan-Mar, 100% for Apr-Jun 22).


 ]
  .panel[.panel-name[All]
```{r UOA_activity_regional, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_all_regions(data = UOA_scheduled_data, 
                                              
                                              historic_data = historical_UDA_scheduled_data,
                                              UDAorUOA = "UOA",
                                              level = "National",
                                              region_STP_name = NULL,
                                              remove_prototypes = TRUE, 
                                              plotChart = TRUE, 
                                              all_regions_and_STPs = FALSE,
                                   include_historic = FALSE)
```


 ]
 .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_UDA_UOA_delivery(data = UOA_scheduled_data,  
                        UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  plotChart = FALSE,
                              all_regions_and_STPs = TRUE)

data %>%
  download_this(
    output_name = "UOA_activity_calendar_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_UDA_UOA_delivery(data = UOA_scheduled_data,  
                        UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  plotChart = FALSE,
                              all_regions_and_STPs = TRUE),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Schedule month","Region Name"),
  columns = list(
    `Monthly UOAs delivered`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Annual contracted UOAs` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Scaled monthly UOAs delivered` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)#,
    #`Scaled monthly percentage of contracted UOAs delivered` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```

]
]

 [Return to contents](#contents)


---

name: uoa-activity-my-cat

### UOA activity data by MY Category
#### Prototypes and contracts with annual contracted UDAs < 100 included

```{r xaringan-panelset-UOA_MY_CAT, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = FALSE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE)
```


 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = FALSE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "South East")
```


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = FALSE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "South West")
```



 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = FALSE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "North West")
```


 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = FALSE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```



 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = FALSE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "London")
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = FALSE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = FALSE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "East of England")
```

 ]
  .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = F)

data %>%
  download_this(
    output_name = "UOA_delivery_calendar_by_MY_category_incl_prototypes_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = F,
                                  regional_lines = F,
                                  STP_lines = F,
                                  cat_lines = T,
                                  plotChart = F),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month"),
  columns = list(
    `Monthly UOAs delivered`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Annual contracted UOAs` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Scaled monthly UOAs delivered` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)#,
    #`Scaled percentage of UOAs delivered` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```
]
]

[Return to contents](#contents)

---

### UOA activity data by MY Category
#### Prototypes and contracts with annual contracted UDAs < 100 excluded

```{r xaringan-panelset-UOA_MY_CAT2, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "National",
                                  region_STP_name = NULL)
```

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "South East")
```


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "South West")
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "North West")
```


 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "London")
```

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = TRUE,
                                  level = "Regional",
                                  region_STP_name = "East of England")
```

 ]
   .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = FALSE)

data %>%
  download_this(
    output_name = "UOA_delivery_calendar_by_MY_category_excl_prototypes_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_UDA_UOA_delivery_MY_cat(
                             data = UOA_scheduled_data,
                                  contractor_cats = contractor_categories,
                                  UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = TRUE,
                                  regional_lines = FALSE,
                                  STP_lines = FALSE,
                                  cat_lines = TRUE,
                                  plotChart = FALSE),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month"),
  columns = list(
    `Monthly UOAs delivered`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Annual contracted UOAs` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Scaled monthly UOAs delivered` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)#,
    #`Scaled percentage of UOAs delivered` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```
]
 ]

 [Return to contents](#contents)

---

name: cumulative-uoas

### UOA cumulative activity data

```{r xaringan-panelset-UOA_cumulative, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              level = "National",
                                              region_STP_name = NULL,
                                              plotChart = TRUE,
                                              all_regions_and_STPs = FALSE,
                                              remove_prototypes = TRUE)
```

* This graph shows the cumulative activity by quarter of the **`r get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "National", region_STP_name = NULL)`**
GDS/PDS contracts measured against the
expected monthly total activity to achieve the quarterly thresholds (100% for Apr-Jun 22).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "National", region_STP_name = NULL)`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "National", region_STP_name = NULL)*100/get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "National", region_STP_name = NULL))` %**
) have delivered the required UOAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              plotChart = TRUE,
                                              all_regions_and_STPs = FALSE,
                                              remove_prototypes = TRUE,
                                  level = "Regional",
                                  region_STP_name = "South East")
```

* This graph shows the cumulative activity by quarter of the **`r get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "South East")`**
GDS/PDS contracts measured against the
expected monthly total activity to achieve the quarterly thresholds (100% for Apr-Jun 22).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "South East")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "South East")*100/get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "South East"))` %**
) have delivered the required UOAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              plotChart = TRUE,
                                              all_regions_and_STPs = FALSE,
                                              remove_prototypes = TRUE,
                                  level = "Regional",
                                  region_STP_name = "South West")
```

* This graph shows the cumulative activity by quarter of the **`r get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "South West")`**
GDS/PDS contracts measured against the
expected monthly total activity to achieve the quarterly thresholds (100% for Apr-Jun 22).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "South West")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "South West")*100/get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "South West"))` %**
) have delivered the required UOAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              plotChart = TRUE,
                                              all_regions_and_STPs = FALSE,
                                              remove_prototypes = TRUE,
                                  level = "Regional",
                                  region_STP_name = "North West")
```

* This graph shows the cumulative activity by quarter of the **`r get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "North West")`**
GDS/PDS contracts measured against the
expected monthly total activity to achieve the quarterly thresholds (100% for Apr-Jun 22).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "North West")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "North West")*100/get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "North West"))` %**
) have delivered the required UOAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.

 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              plotChart = TRUE,
                                              all_regions_and_STPs = FALSE,
                                              remove_prototypes = TRUE,
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```

* This graph shows the cumulative activity by quarter of the **`r get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "North East and Yorkshire")`**
GDS/PDS contracts measured against the
expected monthly total activity to achieve the quarterly thresholds (100% for Apr-Jun 22).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "North East and Yorkshire")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "North East and Yorkshire")*100/get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "North East and Yorkshire"))` %**
) have delivered the required UOAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              plotChart = TRUE,
                                              all_regions_and_STPs = FALSE,
                                              remove_prototypes = TRUE,
                                  level = "Regional",
                                  region_STP_name = "London")
```

* This graph shows the cumulative activity by quarter of the **`r get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "London")`**
GDS/PDS contracts measured against the
expected monthly total activity to achieve the quarterly thresholds (100% for Apr-Jun 22).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "London")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "London")*100/get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "London"))` %**
) have delivered the required UOAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              plotChart = TRUE,
                                              all_regions_and_STPs = FALSE,
                                              remove_prototypes = TRUE,
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```

* This graph shows the cumulative activity by quarter of the **`r get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "Midlands")`**
GDS/PDS contracts measured against the
expected monthly total activity to achieve the quarterly thresholds (100% for Apr-Jun 22).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "Midlands")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "Midlands")*100/get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "Midlands"))` %**
) have delivered the required UOAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              plotChart = TRUE,
                                              all_regions_and_STPs = FALSE,
                                              remove_prototypes = TRUE,
                                  level = "Regional",
                                  region_STP_name = "East of England")
```

* This graph shows the cumulative activity by quarter of the **`r get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "East of England")`**
GDS/PDS contracts measured against the
expected monthly total activity to achieve the quarterly thresholds (100% for Apr-Jun 22).
* From the start of January to the end of `r format(Sys.Date() - lubridate::weeks(4), "%B")`
**`r get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "East of England")`**
contracts (
**`r round(get_quarterly_num_contracts_on_target(UOA_scheduled_data, remove_prototypes = T,  UDAorUOA = "UOA", level = "Regional", region_STP_name = "East of England")*100/get_num_contracts(UOA_scheduled_data, remove_prototypes = T,  "UOA", level = "Regional", region_STP_name = "East of England"))` %**
) have delivered the required UOAs or more to be on track towards the Q4 threshold (100%) by the end of March 2023.


 ]
 .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              remove_prototypes = TRUE,
                                  level = "National",
                                  region_STP_name = NULL,
                                  plotChart = F,
                                  all_regions_and_STPs = T)

data %>%
  download_this(
    output_name = "cumulative_UOA_delivery_calendar_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_cumulative_UDA_UOA_to_target(data = UOA_scheduled_data, 
                                              
                                              UDAorUOA = "UOA", 
                                              remove_prototypes = TRUE,
                                  level = "National",
                                  region_STP_name = NULL,
                                  plotChart = F,
                                  all_regions_and_STPs = T),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month", "Region Name"),
  columns = list(
    `Monthly UOAs delivered`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Quarterly contracted UOAs` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)#,
    #`Montly percentage of quarterly contracted UOAs` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE),
    #`Cumulative percentage of quarterly contracted UOAs` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```
 ]
 ]

 [Return to contents](#contents)

---

name: YTD-uoas

### YTD UOA delivery

```{r xaringan-panelset-UOA-activity_YTD, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  level = "National",
                                  region_STP_name = NULL,
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE)
```


]
.panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "South East")
```


]
.panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "South West")
```


]
.panel[.panel-name[North West]
```{r  echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "North West")
```


]
.panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```


]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "London")
```


]
.panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```


]
.panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5, fig.align='center'}
plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = TRUE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Region",
                                  region_STP_name = "East of England")
```


]
.panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = FALSE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Region",
                                  region_STP_name = "East of England")

data %>%
  download_this(
    output_name = "YTD_UOA_delivery_calendar_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_YTD_UDA_UOA_delivery(data = UOA_scheduled_data, 
                                  
                                  UDAorUOA = "UOA",
                                  remove_prototypes = TRUE, 
                                  plotChart = FALSE, 
                                  all_regions_and_STPs = FALSE,
                                  level = "Region",
                                  region_STP_name = "East of England"),
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE
  
)
```
]
]

[Return to contents](#contents)


---

name: uoa-delivery-profile

### UOA delivery profile

```{r xaringan-panelset-UOA_delivery_profile, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "National",
                          region_STP_name = NULL)
```

* The graph shows the proportion of practices delivering
between a certain % group of contracted UOA activity if performance for that
month is annualised.
This uses scheduled data.

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "Regional",
                          region_STP_name = "South East")
```

* The graph shows the proportion of practices delivering
between a certain % group of contracted UOA activity if performance for that
month is annualised.
This uses scheduled data.


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "Regional",
                          region_STP_name = "South West")
```

* The graph shows the proportion of practices delivering
between a certain % group of contracted UOA activity if performance for that
month is annualised.
This uses scheduled data.


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "Regional",
                          region_STP_name = "North West")
```

* The graph shows the proportion of practices delivering
between a certain % group of contracted UOA activity if performance for that
month is annualised.
This uses scheduled data.

 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "Regional",
                          region_STP_name = "North East and Yorkshire")
```

* The graph shows the proportion of practices delivering
between a certain % group of contracted UOA activity if performance for that
month is annualised.
This uses scheduled data.


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "Regional",
                          region_STP_name = "London")
```

* The graph shows the proportion of practices delivering
between a certain % group of contracted UOA activity if performance for that
month is annualised.
This uses scheduled data.

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "Regional",
                          region_STP_name = "Midlands")
```

* The graph shows the proportion of practices delivering
between a certain % group of contracted UOA activity if performance for that
month is annualised.
This uses scheduled data.


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "Regional",
                          region_STP_name = "East of England")
```

* The graph shows the proportion of practices delivering
between a certain % group of contracted UOA activity if performance for that
month is annualised.
This uses scheduled data.


 ]
 .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "National",
                          region_STP_name = NULL,
                          plotChart = F,
                          all_regions_and_STPs = T)

data %>%
  download_this(
    output_name = "UOA_delivery_profile_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_UDA_UOA_delivery_profile(data = UOA_scheduled_data,
                          
                          UDAorUOA = "UOA",
                          level = "National",
                          region_STP_name = NULL,
                          plotChart = F,
                          all_regions_and_STPs = T),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month", "Performance band", "Region Name"),
  columns = list(
    `Total number of contracts`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Number of contracts in performance band` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)#,
    #`Percentage of contracts in performance band` = colDef(aggregate = "mean", format = colFormat(suffix = "%", digits = 1), filterable = FALSE)
  )
)
```
]
 ]

[Return to contents](#contents)

---

name: banded-cots

### Time series of banded Courses of Treatment

```{r xaringan-panelset-CoTs, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "National",
                region_STP_name = NULL)
```


 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "South East")
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "South West")
```

 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "North West")
```

 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "North East and Yorkshire")
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "London")
```

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "Midlands")
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "East of England")
```

 ]
  .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "National",
                region_STP_name = NULL,
                plotChart = F,
                all_regions_and_STPs = T)

data %>%
  download_this(
    output_name = "banded_CoT_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "National",
                region_STP_name = NULL,
                plotChart = F,
                all_regions_and_STPs = T),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month", "Region Name"),
  columns = list(
    `Band 1`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Band 2` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Band 3`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Urgent` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Other`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)
  )
)
```
]
 ]

[Return to contents](#contents)

---

name: banded-cots-index

### Banded Courses of Treatment as % of 2019 delivery

```{r xaringan-panelset-CoTs2, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "National",
                region_STP_name = NULL,
                asIndex = TRUE)
```


 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "South East",
                asIndex = TRUE)
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "South West",
                asIndex = TRUE)
```

 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "North West",
                asIndex = TRUE)
```

 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "North East and Yorkshire",
                asIndex = TRUE)
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "London",
                asIndex = TRUE)
```

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "Midlands",
                asIndex = TRUE)
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_banded_CoT(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "East of England",
                asIndex = TRUE)
```

 ]
 ]

[Return to contents](#contents)

---

name: urgent-forms

### Urgent treatment form submissions

```{r xaringan-panelset-Urgent-forms, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "National",
                region_STP_name = NULL)
```

* This graph shows the number of urgent treatment forms
declared per month across financial years.
* The urgent treatment form count in
**`r format(Sys.Date() - lubridate::weeks(4), "%B %Y")`**
was
**`r get_num_urgent_forms(level = "National", region_STP_name = NULL)`**
, whilst in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2019**
this number was
**`r get_num_urgent_forms_2019(level = "National", region_STP_name = NULL)`**
, which is a
**`r round((get_num_urgent_forms(level = "National", region_STP_name = NULL) - get_num_urgent_forms_2019(level = "National", region_STP_name = NULL)) *100 / get_num_urgent_forms_2019(level = "National", region_STP_name = NULL))` %**
change from the pre-COVID world.

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "South East")
```

* This graph shows the number of urgent treatment forms
declared per month across financial years.
* The urgent treatment form count in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2021**
was
**`r get_num_urgent_forms(level = "Regional", region_STP_name = "South East")`**
, whilst in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2019**
this number was
**`r get_num_urgent_forms_2019(level = "Regional", region_STP_name = "South East")`**
, which is a
**`r round((get_num_urgent_forms(level = "Regional", region_STP_name = "South East") - get_num_urgent_forms_2019(level = "Regional", region_STP_name = "South East")) *100 / get_num_urgent_forms_2019(level = "Regional", region_STP_name = "South East"))` %**
change from the pre-COVID world.


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "South West")
```

* This graph shows the number of urgent treatment forms
declared per month across financial years.
* The urgent treatment form count in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2021**
was
**`r get_num_urgent_forms(level = "Regional", region_STP_name = "South West")`**
, whilst in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2019**
this number was
**`r get_num_urgent_forms_2019(level = "Regional", region_STP_name = "South West")`**
, which is a
**`r round((get_num_urgent_forms(level = "Regional", region_STP_name = "South West") - get_num_urgent_forms_2019(level = "Regional", region_STP_name = "South West")) *100 / get_num_urgent_forms_2019(level = "Regional", region_STP_name = "South West"))` %**
change from the pre-COVID world.


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "North West")
```

* This graph shows the number of urgent treatment forms
declared per month across financial years.
* The urgent treatment form count in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2021**
was
**`r get_num_urgent_forms(level = "Regional", region_STP_name = "North West")`**
, whilst in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2019**
this number was
**`r get_num_urgent_forms_2019(level = "Regional", region_STP_name = "North West")`**
, which is a
**`r round((get_num_urgent_forms(level = "Regional", region_STP_name = "North West") - get_num_urgent_forms_2019(level = "Regional", region_STP_name = "North West")) *100 / get_num_urgent_forms_2019(level = "Regional", region_STP_name = "North West"))` %**
change from the pre-COVID world.


 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "North East and Yorkshire")
```

* This graph shows the number of urgent treatment forms
declared per month across financial years.
* The urgent treatment form count in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2021**
was
**`r get_num_urgent_forms(level = "Regional", region_STP_name = "North East and Yorkshire")`**
, whilst in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2019**
this number was
**`r get_num_urgent_forms_2019(level = "Regional", region_STP_name = "North East and Yorkshire")`**
, which is a
**`r round((get_num_urgent_forms(level = "Regional", region_STP_name = "North East and Yorkshire") - get_num_urgent_forms_2019(level = "Regional", region_STP_name = "North East and Yorkshire")) *100 / get_num_urgent_forms_2019(level = "Regional", region_STP_name = "North East and Yorkshire"))` %**
change from the pre-COVID world.


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "London")
```

* This graph shows the number of urgent treatment forms
declared per month across financial years.
* The urgent treatment form count in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2021**
was
**`r get_num_urgent_forms(level = "Regional", region_STP_name = "London")`**
, whilst in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2019**
this number was
**`r get_num_urgent_forms_2019(level = "Regional", region_STP_name = "London")`**
, which is a
**`r round((get_num_urgent_forms(level = "Regional", region_STP_name = "London") - get_num_urgent_forms_2019(level = "Regional", region_STP_name = "London")) *100 / get_num_urgent_forms_2019(level = "Regional", region_STP_name = "London"))` %**
change from the pre-COVID world.

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "Midlands")
```

* This graph shows the number of urgent treatment forms
declared per month across financial years.
* The urgent treatment form count in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2021**
was
**`r get_num_urgent_forms(level = "Regional", region_STP_name = "Midlands")`**
, whilst in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2019**
this number was
**`r get_num_urgent_forms_2019(level = "Regional", region_STP_name = "Midlands")`**
, which is a
**`r round((get_num_urgent_forms(level = "Regional", region_STP_name = "Midlands") - get_num_urgent_forms_2019(level = "Regional", region_STP_name = "Midlands")) *100 / get_num_urgent_forms_2019(level = "Regional", region_STP_name = "Midlands"))` %**
change from the pre-COVID world.

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "Regional",
                region_STP_name = "East of England")
```

* This graph shows the number of urgent treatment forms
declared per month across financial years.
* The urgent treatment form count in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2021**
was
**`r get_num_urgent_forms(level = "Regional", region_STP_name = "East of England")`**
, whilst in
**`r format(Sys.Date() - lubridate::weeks(4), "%B")` 2019**
this number was
**`r get_num_urgent_forms_2019(level = "Regional", region_STP_name = "East of England")`**
, which is a
**`r round((get_num_urgent_forms(level = "Regional", region_STP_name = "East of England") - get_num_urgent_forms_2019(level = "Regional", region_STP_name = "East of England")) *100 / get_num_urgent_forms_2019(level = "Regional", region_STP_name = "East of England"))` %**
change from the pre-COVID world.

 ]
   .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "National",
                region_STP_name = NULL,
                plotChart = F,
                all_regions_and_STPs = T)

data %>%
  download_this(
    output_name = "urgent_forms_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_urgent_form_submissions(data = UDA_scheduled_data,
                
                historic_data = historical_UDA_scheduled_data,
                remove_prototypes = FALSE,
                level = "National",
                region_STP_name = NULL,
                plotChart = F,
                all_regions_and_STPs = T),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month", "Region Name"),
  columns = list(
    `Urgent forms` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)
  )
)
```
]
 ]

[Return to contents](#contents)

---

name: band2-split-FP17-perc

### Percentage of FP17s in each band 2 sub-category

```{r xaringan-panelset-band2-split-FP17-perc, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[
.panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                           level = "National",
                           region_STP_name = NULL,
                             plotChart = TRUE)
```

]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "Regional",
                                region_STP_name = "South East",
                                plotChart = TRUE)
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "Regional",
                                region_STP_name = "South West",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "Regional",
                                region_STP_name = "North West",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "Regional",
                                region_STP_name = "North East and Yorkshire",
                                plotChart = TRUE)
```


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "Regional",
                                region_STP_name = "London",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "Regional",
                                region_STP_name = "Midlands",
                                plotChart = TRUE)
```



 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "Regional",
                                region_STP_name = "East of England",
                                plotChart = TRUE)
```


 ] 
 .panel[.panel-name[Data]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=6}

data <- plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "National",
                                region_STP_name = NULL,
                                plotChart = FALSE)

data %>%
  download_this(
    output_name = "band2_split_UDA_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_band2_split_percentage(data = band2_split_data,
                             scheduled_data = UDA_scheduled_data,
                             remove_prototypes = FALSE, 
                             commissioner_region_lookup = STP_ICB_lookup_codes,
                                level = "National",
                                region_STP_name = NULL,
                                plotChart = FALSE),
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE
)
```

 ]
 ]

The number of FP17s delivered in each sub-band can be found in the "Data" tab on this slide. 

[Return to contents](#contents)


---

name: patient-charge

### UDAs delivered by Patient Charge Status

```{r xaringan-panelset-patient-charge, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDAs_by_patient_exemption(data = patient_exemption_data,
                               region_filter = "England")
```


 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDAs_by_patient_exemption(data = patient_exemption_data,
                               region_filter = "South East")
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDAs_by_patient_exemption(data = patient_exemption_data,
                               region_filter = "South West")
```

 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDAs_by_patient_exemption(data = patient_exemption_data,
                               region_filter = "North West")
```

 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDAs_by_patient_exemption(data = patient_exemption_data,
                               region_filter = "North East and Yorkshire")
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDAs_by_patient_exemption(data = patient_exemption_data,
                               region_filter = "London")
```

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDAs_by_patient_exemption(data = patient_exemption_data,
                               region_filter = "Midlands")
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDAs_by_patient_exemption(data = patient_exemption_data,
                               region_filter = "East of England")
```

 ]
 ]

[Return to contents](#contents)

---

name: uda-projection

### Contracts that have delivered at least 96% of contracted UDAs

```{r echo = FALSE, warning = FALSE, message = FALSE, , fig.width=14, fig.height=5}
plot_UDA_yearly_delivery(level = "Regional")
```

 96% is the delivery threshold that contracts are required to meet in order to be paid in full. If they deliver below this, they will be in clawback.


[Return to contents](#contents)

---

name: 111-call-volumes

### 111 dental related call volumes

```{r xaringan-panelset-111_volumes_breakdown, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_111_referrals()
```


 ]
  .panel[.panel-name[National breakdown by disposition]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_breakdown_111_referrals()
```


 ]
 .panel[.panel-name[Data]
<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_breakdown_111_referrals(plotChart = F)

data %>%
  download_this(
    output_name = "dental_111_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_breakdown_111_referrals(plotChart = F),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  columns = list(
    `Monthly case volume` = colDef(filterable = FALSE)
  )
)
```
 ]
 ]

[Return to contents](#contents)

---

name: dcp-fp17

### Percentage of CoTs assisted by Dental Care Practitioners (DCPs)

```{r xaringan-panelset-UDA-activity-dcp-fp17, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "FP17",
                              level = "National",
                              region_STP_name = NULL)
```

]
.panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "FP17",
                                  level = "Regional",
                                  region_STP_name = "South East")
```


]
.panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "FP17",
                                  level = "Regional",
                                  region_STP_name = "South West")
```


]
.panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "FP17",
                                  level = "Regional",
                                  region_STP_name = "North West")
```


]
.panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "FP17",
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```


]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "FP17",
                                  level = "Regional",
                                  region_STP_name = "London")
```


]
.panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "FP17",
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```


]
.panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "FP17",
                                  level = "Regional",
                                  region_STP_name = "East of England")
```


] 
]
N.B. This data has only been collected since October 2022 and may take a few months for contractors to get used to reporting on DCP assisted courses of treatment.

[Return to contents](#contents)

---

name: dcp-uda

### Percentage of UDAs assisted by Dental Care Practitioners (DCPs)

```{r xaringan-panelset-UDA-activity-dcp-uda, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

.panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "UDA",
                              level = "National",
                              region_STP_name = NULL)
```

]
.panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "UDA",
                                  level = "Regional",
                                  region_STP_name = "South East")
```


]
.panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "UDA",
                                  level = "Regional",
                                  region_STP_name = "South West")
```


]
.panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "UDA",
                                  level = "Regional",
                                  region_STP_name = "North West")
```


]
.panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "UDA",
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```


]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "UDA",
                                  level = "Regional",
                                  region_STP_name = "London")
```


]
.panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "UDA",
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```


]
.panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_DCP_analysis(data = UDA_scheduled_data,
                              dcp_data = DCP_data,
                              
                              UDA_or_FP17 = "UDA",
                                  level = "Regional",
                                  region_STP_name = "East of England")
```


]
]
N.B. This data has only been collected since October 2022 and may take a few months for contractors to get used to reporting on DCP assisted courses of treatment. 

[Return to contents](#contents)

---

name: bpe

### Oral health risk assessment

```{r xaringan-panelset-bpe, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="1">
.panelset[

.panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_BPE_no_oral_health_risk(data = BPE_data,
                                         ICB_lookup = STP_ICB_lookup_codes,
                                         level = "National",
                                         region_STP_name = NULL)
```

The boxplot for **`r format(plot_BPE_no_oral_health_risk(level = "National", region_STP_name = NULL, plotChart = FALSE, quartileOutput = NULL), "%B %Y")`** shows that: 
* A quarter of contracts brought back **`r paste(plot_BPE_no_oral_health_risk(level = "National", region_STP_name = NULL, plotChart = FALSE, quartileOutput = "UQ"))`** of their low risk patients within one year
* Half of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "National", region_STP_name = NULL, plotChart = FALSE, quartileOutput = "Median"))`** of their low risk patients within one year
* Three quarters of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "National", region_STP_name = NULL, plotChart = FALSE, quartileOutput = "LQ"))`** of their low risk patients within one year

].panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_BPE_no_oral_health_risk(data = BPE_data,
                                         ICB_lookup = STP_ICB_lookup_codes,
                                  level = "Regional",
                                  region_STP_name = "South East")
```

The boxplot for **`r format(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "South East", plotChart = FALSE, quartileOutput = NULL), "%B %Y")`** shows that: 
* A quarter of contracts brought back **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "South East", plotChart = FALSE, quartileOutput = "UQ"))`** of their low risk patients within one year
* Half of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "South East", plotChart = FALSE, quartileOutput = "Median"))`** of their low risk patients within one year
* Three quarters of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "South East", plotChart = FALSE, quartileOutput = "LQ"))`** of their low risk patients within one year

]
.panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_BPE_no_oral_health_risk(data = BPE_data,
                                         ICB_lookup = STP_ICB_lookup_codes,
                                  level = "Regional",
                                  region_STP_name = "South West")
```

The boxplot for **`r format(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "South West", plotChart = FALSE, quartileOutput = NULL), "%B %Y")`** shows that: 
* A quarter of contracts brought back **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "South West", plotChart = FALSE, quartileOutput = "UQ"))`** of their low risk patients within one year
* Half of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "South West", plotChart = FALSE, quartileOutput = "Median"))`** of their low risk patients within one year
* Three quarters of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "South West", plotChart = FALSE, quartileOutput = "LQ"))`** of their low risk patients within one year

]
.panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_BPE_no_oral_health_risk(data = BPE_data,
                                         ICB_lookup = STP_ICB_lookup_codes,
                                  level = "Regional",
                                  region_STP_name = "North West")
```

The boxplot for **`r format(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "North West", plotChart = FALSE, quartileOutput = NULL), "%B %Y")`** shows that: 
* A quarter of contracts brought back **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "North West", plotChart = FALSE, quartileOutput = "UQ"))`** of their low risk patients within one year
* Half of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "North West", plotChart = FALSE, quartileOutput = "Median"))`** of their low risk patients within one year
* Three quarters of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "North West", plotChart = FALSE, quartileOutput = "LQ"))`** of their low risk patients within one year

]
.panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_BPE_no_oral_health_risk(data = BPE_data,
                                         ICB_lookup = STP_ICB_lookup_codes,
                                  level = "Regional",
                                  region_STP_name = "North East and Yorkshire")
```

The boxplot for **`r format(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "North East and Yorkshire", plotChart = FALSE, quartileOutput = NULL), "%B %Y")`** shows that: 
* A quarter of contracts brought back **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "North East and Yorkshire", plotChart = FALSE, quartileOutput = "UQ"))`** of their low risk patients within one year
* Half of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "North East and Yorkshire", plotChart = FALSE, quartileOutput = "Median"))`** of their low risk patients within one year
* Three quarters of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "North East and Yorkshire", plotChart = FALSE, quartileOutput = "LQ"))`** of their low risk patients within one year

]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_BPE_no_oral_health_risk(data = BPE_data,
                                         ICB_lookup = STP_ICB_lookup_codes,
                                  level = "Regional",
                                  region_STP_name = "London")
```

The boxplot for **`r format(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "London", plotChart = FALSE, quartileOutput = NULL), "%B %Y")`** shows that: 
* A quarter of contracts brought back **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "London", plotChart = FALSE, quartileOutput = "UQ"))`** of their low risk patients within one year
* Half of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "London", plotChart = FALSE, quartileOutput = "Median"))`** of their low risk patients within one year
* Three quarters of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "London", plotChart = FALSE, quartileOutput = "LQ"))`** of their low risk patients within one year

]
.panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_BPE_no_oral_health_risk(data = BPE_data,
                                         ICB_lookup = STP_ICB_lookup_codes,
                                  level = "Regional",
                                  region_STP_name = "Midlands")
```

The boxplot for **`r format(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "Midlands", plotChart = FALSE, quartileOutput = NULL), "%B %Y")`** shows that: 
* A quarter of contracts brought back **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "Midlands", plotChart = FALSE, quartileOutput = "UQ"))`** of their low risk patients within one year
* Half of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "Midlands", plotChart = FALSE, quartileOutput = "Median"))`** of their low risk patients within one year
* Three quarters of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "Midlands", plotChart = FALSE, quartileOutput = "LQ"))`** of their low risk patients within one year

]
.panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_BPE_no_oral_health_risk(data = BPE_data,
                                         ICB_lookup = STP_ICB_lookup_codes,
                                  level = "Regional",
                                  region_STP_name = "East of England")
```

The boxplot for **`r format(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "East of England", plotChart = FALSE, quartileOutput = NULL), "%B %Y")`** shows that: 
* A quarter of contracts brought back **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "East of England", plotChart = FALSE, quartileOutput = "UQ"))`** of their low risk patients within one year
* Half of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "East of England", plotChart = FALSE, quartileOutput = "Median"))`** of their low risk patients within one year
* Three quarters of contracts brought back at least **`r paste(plot_BPE_no_oral_health_risk(level = "Regional", region_STP_name = "East of England", plotChart = FALSE, quartileOutput = "LQ"))`** of their low risk patients within one year


]
]

Low risk is defined as having BPE (Basic Periodontal Examination) Score of 0 or 1 and no new tooth decay. 

[Return to contents](#contents)


---

name: unique-patients

### Unique dental patients seen

```{r xaringan-panelset-Unique-patients, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "National",
                                     region_STP_name = NULL,
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "National",region_STP_name = NULL, plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "South East",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "South East", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "South West",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "South West", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "North West",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "North West", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "North East and Yorkshire",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "North East and Yorkshire", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "London",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "London", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "Midlands",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "Midlands", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "East of England",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "East of England", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
  .panel[.panel-name[Data]

<font size="1">

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}

data <- plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "National",
                                     region_STP_name = NULL,
                                     plotChart = FALSE,
                                     remove_prototypes = FALSE,
                                     all_regiona_and_STPs = TRUE)

data %>%
  download_this(
    output_name = "unique_patients_12_month_rolling_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "National",
                                     region_STP_name = NULL,
                                     plotChart = FALSE,
                                     remove_prototypes = FALSE,
                                     all_regiona_and_STPs = TRUE),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("12 month period end", "Region Name"),
  columns = list(
    `Any band unique patients rolling 12 month` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Band 1 unique patients rolling 12 month` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Band 2 or 3 unique patients rolling 12 month` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Urgent band 1 unique patients rolling 12 month` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Other unique patients rolling 12 month` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)
  )
)
```
 ]
 ]
 
N.B. This analysis now includes all contracts.

[Return to contents](#contents)


---

name: unique-patients-index

### Unique dental patients seen as a percentage of April 2018 figures

```{r xaringan-panelset-Unique-patients2, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "National",
                                     region_STP_name = NULL,
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE,
                             asIndex = TRUE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "National",region_STP_name = NULL, plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "South East",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE,
                             asIndex = TRUE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "South East", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "South West",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE,
                             asIndex = TRUE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "South West", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "North West",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE,
                             asIndex = TRUE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "North West", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "North East and Yorkshire",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE,
                             asIndex = TRUE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "North East and Yorkshire", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "London",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE,
                             asIndex = TRUE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "London", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "Midlands",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE,
                             asIndex = TRUE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "Midlands", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_unique_patients_rolling(data = unique_patients_rolling,
                                     
                                     scheduled_data = UDA_scheduled_data,
                                     level = "Regional",
                                     region_STP_name = "East of England",
                                     plotChart = TRUE,
                                     remove_prototypes = FALSE,
                             asIndex = TRUE)
```

* The number of unique patients seen in the last 12 months is currently around
**`r plot_unique_patients_rolling(level = "Regional",region_STP_name = "East of England", plotChart = F,remove_prototypes = FALSE, get_perc = T)` %**
of pre-pandemic levels.

 ]
 ]

[Return to contents](#contents)

---

name: new-patients

### New patients seen 

```{r xaringan-panelset-new-pataients-seen, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = FALSE,
                                                  level = "National",
                                                  region_STP_name = NULL)
```

]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = FALSE,
                                     level = "Regional",
                                     region_STP_name = "South East")
```


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = FALSE,
                                     level = "Regional",
                                     region_STP_name = "South West")
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = FALSE,
                                     level = "Regional",
                                     region_STP_name = "North West")
```


 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = FALSE,
                                     level = "Regional",
                                     region_STP_name = "North East and Yorkshire")
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = FALSE,
                                     level = "Regional",
                                     region_STP_name = "London")
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = FALSE,
                                     level = "Regional",
                                     region_STP_name = "Midlands")
```

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = FALSE,
                                     level = "Regional",
                                     region_STP_name = "East of England")
```

 ]
 ]

[Return to contents](#contents)

---

name: new-patients-perc

### Percentage of providers seeing new patients

```{r xaringan-panelset-perc-new-patients, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = TRUE,
                                                  level = "National",
                                                  region_STP_name = NULL)
```

]
 .panel[.panel-name[South East]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = TRUE,
                                     level = "Regional",
                                     region_STP_name = "South East")
```


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = TRUE,
                                     level = "Regional",
                                     region_STP_name = "South West")
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = TRUE,
                                     level = "Regional",
                                     region_STP_name = "North West")
```


 ]
 .panel[.panel-name[North East and Yorkshire]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = TRUE,
                                     level = "Regional",
                                     region_STP_name = "North East and Yorkshire")
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = TRUE,
                                     level = "Regional",
                                     region_STP_name = "London")
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = TRUE,
                                     level = "Regional",
                                     region_STP_name = "Midlands")
```

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_number_new_patients(data = new_vs_return_data, 
                                                  scheduled_data = UDA_scheduled_data,
                                                  as_percentage = TRUE,
                                     level = "Regional",
                                     region_STP_name = "East of England")
```

 ]
 ]

[Return to contents](#contents)

---

name: reattendance

### Patient re-attendance intervals

```{r xaringan-panelset-reattendance, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[Band 1]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=12, fig.height=6}
plot_patient_recalls_facet(data = dental_recalls_STP_2018_22,
                                 treatment_band = "Band_1",
                                 level = "National",
                                 region_STP_name = NULL,
                                 
                                 plotChart = TRUE)
```

 ]
 .panel[.panel-name[Band 2]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=12, fig.height=6}
plot_patient_recalls_facet(data = dental_recalls_STP_2018_22,
                                 treatment_band = "Band_2",
                                 level = "National",
                                 region_STP_name = NULL,
                                 
                                 plotChart = TRUE)
```

 ]
 .panel[.panel-name[Band 3]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=12, fig.height=6}
plot_patient_recalls_facet(data = dental_recalls_STP_2018_22,
                                 treatment_band = "Band_3",
                                 level = "National",
                                 region_STP_name = NULL,
                                 
                                 plotChart = TRUE)
```

 ]
 .panel[.panel-name[Urgent]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=12, fig.height=6}
plot_patient_recalls_facet(data = dental_recalls_STP_2018_22,
                                 treatment_band = "Urgent",
                                 level = "National",
                                 region_STP_name = NULL,
                                 
                                 plotChart = TRUE)
```

 ]
  .panel[.panel-name[Other]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=12, fig.height=6}
plot_patient_recalls_facet(data = dental_recalls_STP_2018_22,
                                 treatment_band = "Other",
                                 level = "National",
                                 region_STP_name = NULL,
                                 
                                 plotChart = TRUE)
```

 ]
  .panel[.panel-name[Data - Regional and Commissioner]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=6}

data <- plot_patient_recalls_facet(data = dental_recalls_STP_2018_22,
                                 treatment_band = "Band_1",
                                 level = "National",
                                 region_STP_name = NULL,
                                 
                                 plotChart = FALSE)

data %>%
  download_this(
    output_name = "patient_reattandance_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_patient_recalls_facet(data = dental_recalls_STP_2018_22,
                                 treatment_band = "Band_1",
                                 level = "National",
                                 region_STP_name = NULL,
                                 
                                 plotChart = FALSE),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Financial Year", "Region Name", "Commissioner Name", "Patient Group" ),
  columns = list(
    `Months Since Last Visit` = colDef(filterable = FALSE),
    `Band 1` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Band 2` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Band 3` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Other` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Urgent` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)
  )
)
```
 ]
 ]

[Return to contents](#contents)

---

name: cds

### Community Dental Services (CDS) - Patients waiting for assessment

```{r xaringan-panelset-CDS1, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_assessment(data = CDS_data,
                                                     
                                                     level = "National",
                                                     region_STP_name = NULL,
                                                     all_regions_and_STPs = FALSE)
```

 ]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "South East",
                                                     all_regions_and_STPs = FALSE)
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "South West",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "North West",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "North East and Yorkshire",
                                                     all_regions_and_STPs = FALSE)
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "London",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "Midlands",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "East of England",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 ]

[Return to contents](#contents)

---

name: cds-treatment

### CDS - Patients waiting for treatment

```{r xaringan-panelset-CDS2, echo=FALSE}
xaringanExtra::use_panelset()
```
 <font size="2">
.panelset[

 .panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_treatment(data = CDS_data,
                                                     
                                                     level = "National",
                                                     region_STP_name = NULL,
                                                     all_regions_and_STPs = FALSE)
```

 ]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "South East",
                                                     all_regions_and_STPs = FALSE)
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "South West",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "North West",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "North East and Yorkshire",
                                                     all_regions_and_STPs = FALSE)
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "London",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "Midlands",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_patients_waiting_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "East of England",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 ]

[Return to contents](#contents)

---

name: cds-wait-weeks-assessment

### CDS - Wait times for assessment

```{r xaringan-panelset-CDS3, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[

 .panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_assessment(data = CDS_data,
                                                     
                                                     level = "National",
                                                     region_STP_name = NULL,
                                                     all_regions_and_STPs = FALSE)
```

 ]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "South East",
                                                     all_regions_and_STPs = FALSE)
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "South West",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "North West",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "North East and Yorkshire",
                                                     all_regions_and_STPs = FALSE)
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "London",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "Midlands",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_assessment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "East of England",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 ]

[Return to contents](#contents)

---

name: cds-wait-weeks-treatment

### CDS - Wait times for treatment

```{r xaringan-panelset-CDS4, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[

 .panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_treatment(data = CDS_data,
                                                     
                                                     level = "National",
                                                     region_STP_name = NULL,
                                                     all_regions_and_STPs = FALSE)
```

 ]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "South East",
                                                     all_regions_and_STPs = FALSE)
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "South West",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "North West",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "North East and Yorkshire",
                                                     all_regions_and_STPs = FALSE)
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "London",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "Midlands",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_CDS_wait_times_for_treatment(data = CDS_data,
                                                     
                                                     level = "Regional",
                                                     region_STP_name = "East of England",
                                                     all_regions_and_STPs = FALSE)
```


 ]
 ]

[Return to contents](#contents)

---
name: closures

### Contract closures

```{r xaringan-panelset-closures, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[

 .panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_practice_closures(data = contract_handbacks,
                                level = "National",
                                region_STP_name = NULL,
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

 ]
 
For context, there are **`r get_num_contracts(remove_prototypes = FALSE)`** nationally, including prototypes and contracts with annual contracted UDAs < 100.

 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_practice_closures(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "South East",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

For context, there are **`r get_num_contracts(remove_prototypes = FALSE, level = "Regional", region_STP_name = "South East")`** in this region, including prototypes and contracts with annual contracted UDAs < 100.
 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_practice_closures(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "South West",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

For context, there are **`r get_num_contracts(remove_prototypes = FALSE, level = "Regional", region_STP_name = "South West")`** in this region, including prototypes and contracts with annual contracted UDAs < 100.

 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_practice_closures(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "North West",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

For context, there are **`r get_num_contracts(remove_prototypes = FALSE, level = "Regional", region_STP_name = "North West")`** in this region, including prototypes and contracts with annual contracted UDAs < 100.

 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_practice_closures(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "North East and Yorkshire",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

For context, there are **`r get_num_contracts(remove_prototypes = FALSE, level = "Regional", region_STP_name = "North East and Yorkshire")`** in this region, including prototypes and contracts with annual contracted UDAs < 100.

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_practice_closures(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "London",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

For context, there are **`r get_num_contracts(remove_prototypes = FALSE, level = "Regional", region_STP_name = "London")`** in this region, including prototypes and contracts with annual contracted UDAs < 100.

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_practice_closures(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "Midlands",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

For context, there are **`r get_num_contracts(remove_prototypes = FALSE, level = "Regional", region_STP_name = "Midlands")`** in this region, including prototypes and contracts with annual contracted UDAs < 100.

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_practice_closures(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "East of England",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

For context, there are **`r get_num_contracts(remove_prototypes = FALSE, level = "Regional", region_STP_name = "East of England")`** in this region, including prototypes and contracts with annual contracted UDAs < 100.

 ].panel[.panel-name[Data]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=6}

data <- plot_practice_closures(data = contract_handbacks,
                                level = "National",
                                region_STP_name = NULL,
                                all_regions_and_STPs = TRUE,
                                plotChart = FALSE)

data %>%
  download_this(
    output_name = "practice_closures_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_practice_closures(data = contract_handbacks,
                                level = "National",
                                region_STP_name = NULL,
                                all_regions_and_STPs = TRUE,
                                plotChart = FALSE),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Time period", "Region Name"),
  columns = list(
    `Number of closures` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)
  )
)
```
 ]
 ]

This data is taken from the BSA Primary Care Activity Report (PCAR). Prior to October 2021, the report was quarterly which is why the figures in these graph show aggregated figures for Q1 and Q2 2021 and then monthly figures after that. Prior to Q1 2021, the data for this report was collected differently and is not comparable.

[Return to contents](#contents)

---

name: de-and-re-commissioned

### De-commissioned and re-commissioned UDAs and UOAs as a result of closure

```{r xaringan-panelset-recommissons, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[

 .panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "National",
                                region_STP_name = NULL,
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

 ]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "South East",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "South West",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```



 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "North West",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "North East and Yorkshire",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "London",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "Midlands",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "Regional",
                                region_STP_name = "East of England",
                                all_regions_and_STPs = FALSE,
                                plotChart = TRUE)
```


 ].panel[.panel-name[Data]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=6}

data <- plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "National",
                                region_STP_name = NULL,
                                all_regions_and_STPs = TRUE,
                                plotChart = FALSE)

data %>%
  download_this(
    output_name = "practice_closures_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_re_and_de_commissioned_UDAs_UOAs(data = contract_handbacks,
                                level = "National",
                                region_STP_name = NULL,
                                all_regions_and_STPs = TRUE,
                                plotChart = FALSE),
  height = 400,
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Time period", "Region name", "Re- or de- commission"),
  columns = list(
    `UDAs or UOAs re- or de- commissioned` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)
  )
)
```
 ]
 ]
 
This data is taken from the BSA Primary Care Activity Report (PCAR). Prior to October 2021, the report was quarterly which is why the figures in these graph show aggregated figures for Q1 and Q2 2021 and then monthly figures after that. Prior to Q1 2021, the data for this report was collected differently and is not comparable.

[Return to contents](#contents)


---
name: annual-contracted-UDAs-trend

### Annual contracted UDAs trend

```{r xaringan-panelset-annual-contracted-trend, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[
.panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDAs_commissioned(data = UDA_scheduled_data,
                                     historical_data = historical_UDA_scheduled_data,
                                level = "National",
                                region_STP_name = NULL,
                                plotChart = TRUE)
```

The change in total annual contracted UDAs from `r format(Sys.Date() - lubridate::weeks(4), "%B")` 2018 to `r format(Sys.Date() - lubridate::weeks(4), "%B %Y")` is
**`r plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,level = "National",region_STP_name = NULL,plotChart = FALSE, getChange = TRUE)`%**.
 ]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,
                                level = "Regional",
                                region_STP_name = "South East",
                                plotChart = TRUE)
```

The change in total annual contracted UDAs from `r format(Sys.Date() - lubridate::weeks(4), "%B")` 2018 to `r format(Sys.Date() - lubridate::weeks(4), "%B %Y")` is
**`r plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,level = "Regional",region_STP_name = "South East",plotChart = FALSE, getChange = TRUE)`%**.
 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,
                                level = "Regional",
                                region_STP_name = "South West",
                                plotChart = TRUE)
```

The change in total annual contracted UDAs from `r format(Sys.Date() - lubridate::weeks(4), "%B")` 2018 to `r format(Sys.Date() - lubridate::weeks(4), "%B %Y")` is
**`r plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,level = "Regional",region_STP_name = "South West",plotChart = FALSE, getChange = TRUE)`%**.

 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,
                                level = "Regional",
                                region_STP_name = "North West",
                                plotChart = TRUE)
```

The change in total annual contracted UDAs from `r format(Sys.Date() - lubridate::weeks(4), "%B")` 2018 to `r format(Sys.Date() - lubridate::weeks(4), "%B %Y")` is
**`r plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,level = "Regional",region_STP_name = "North West",plotChart = FALSE, getChange = TRUE)`%**.

 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,
                                level = "Regional",
                                region_STP_name = "North East and Yorkshire",
                                plotChart = TRUE)
```

The change in total annual contracted UDAs from `r format(Sys.Date() - lubridate::weeks(4), "%B")` 2018 to `r format(Sys.Date() - lubridate::weeks(4), "%B %Y")` is
**`r plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,level = "Regional",region_STP_name = "North East and Yorkshire",plotChart = FALSE, getChange = TRUE)`%**.

 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,
                                level = "Regional",
                                region_STP_name = "London",
                                plotChart = TRUE)
```

The change in total annual contracted UDAs from `r format(Sys.Date() - lubridate::weeks(4), "%B")` 2018 to `r format(Sys.Date() - lubridate::weeks(4), "%B %Y")` is
**`r plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,level = "Regional",region_STP_name = "London",plotChart = FALSE, getChange = TRUE)`%**.

 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,
                                level = "Regional",
                                region_STP_name = "Midlands",
                                plotChart = TRUE)
```

The change in total annual contracted UDAs from `r format(Sys.Date() - lubridate::weeks(4), "%B")` 2018 to `r format(Sys.Date() - lubridate::weeks(4), "%B %Y")` is
**`r plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,level = "Regional",region_STP_name = "Midlands",plotChart = FALSE, getChange = TRUE)`%**.

 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,
                                level = "Regional",
                                region_STP_name = "East of England",
                                plotChart = TRUE)
```

The change in total annual contracted UDAs from `r format(Sys.Date() - lubridate::weeks(4), "%B")` 2018 to `r format(Sys.Date() - lubridate::weeks(4), "%B %Y")` is
**`r plot_UDAs_commissioned(data = UDA_scheduled_data, historical_data = historical_UDA_scheduled_data,level = "Regional",region_STP_name = "East of England",plotChart = FALSE, getChange = TRUE)`%**.

 ]
 ]
 
The dips seen every April may be due to the fact that new contracts starting at the beginning of the financial year will not have submitted any FP17s until May, which means that their contracted UDA data will not show up until May.

[Return to contents](#contents)


---
name: payments

### Payments to dentists

```{r xaringan-panelset-payments, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[
.panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_payments_to_dentists(data = payments_to_dentists,
                                level = "National",
                                region_STP_name = NULL,
                                plotChart = TRUE)
```

]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_payments_to_dentists(data = payments_to_dentists,
                                level = "Regional",
                                region_STP_name = "South East",
                                plotChart = TRUE)
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_payments_to_dentists(data = payments_to_dentists,
                                level = "Regional",
                                region_STP_name = "South West",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_payments_to_dentists(data = payments_to_dentists,
                                level = "Regional",
                                region_STP_name = "North West",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_payments_to_dentists(data = payments_to_dentists,
                                level = "Regional",
                                region_STP_name = "North East and Yorkshire",
                                plotChart = TRUE)
```


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_payments_to_dentists(data = payments_to_dentists,
                                level = "Regional",
                                region_STP_name = "London",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_payments_to_dentists(data = payments_to_dentists,
                                level = "Regional",
                                region_STP_name = "Midlands",
                                plotChart = TRUE)
```



 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_payments_to_dentists(data = payments_to_dentists,
                                level = "Regional",
                                region_STP_name = "East of England",
                                plotChart = TRUE)
```


 ]
 ]

[Return to contents](#contents)

---
name: uda-value

### Cumulative financial value of UDAs delivered

```{r xaringan-panelset-uda-value, echo=FALSE}
xaringanExtra::use_panelset()
```

 <font size="2">
.panelset[
.panel[.panel-name[National]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_value(data = UDA_scheduled_data,
                           historical_data = historical_UDA_scheduled_data,
                           payments_data = payments_to_dentists,
                           UDA_value_data = UDA_UOA_value_data,
                           protos = prototype_contracts$prototype_contract_number,
                           level = "National",
                           region_STP_name = NULL,
                           all_regions_and_STPs = FALSE,
                           asIndex = FALSE,
                           plotChart = TRUE)
```

]
 .panel[.panel-name[South East]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_value(data = UDA_scheduled_data,
                           historical_data = historical_UDA_scheduled_data,
                           payments_data = payments_to_dentists,
                           UDA_value_data = UDA_UOA_value_data,
                           protos = prototype_contracts$prototype_contract_number,
                           all_regions_and_STPs = FALSE,
                           asIndex = FALSE,
                                level = "Regional",
                                region_STP_name = "South East",
                                plotChart = TRUE)
```

 ]
 .panel[.panel-name[South West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_value(data = UDA_scheduled_data,
                           historical_data = historical_UDA_scheduled_data,
                           payments_data = payments_to_dentists,
                           UDA_value_data = UDA_UOA_value_data,
                           protos = prototype_contracts$prototype_contract_number,
                           all_regions_and_STPs = FALSE,
                           asIndex = FALSE,
                                level = "Regional",
                                region_STP_name = "South West",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[North West]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_value(data = UDA_scheduled_data,
                           historical_data = historical_UDA_scheduled_data,
                           payments_data = payments_to_dentists,
                           UDA_value_data = UDA_UOA_value_data,
                           protos = prototype_contracts$prototype_contract_number,
                           all_regions_and_STPs = FALSE,
                           asIndex = FALSE,
                                level = "Regional",
                                region_STP_name = "North West",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[North East and Yorkshire]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_value(data = UDA_scheduled_data,
                           historical_data = historical_UDA_scheduled_data,
                           payments_data = payments_to_dentists,
                           UDA_value_data = UDA_UOA_value_data,
                           protos = prototype_contracts$prototype_contract_number,
                           all_regions_and_STPs = FALSE,
                           asIndex = FALSE,
                                level = "Regional",
                                region_STP_name = "North East and Yorkshire",
                                plotChart = TRUE)
```


 ]
.panel[.panel-name[London]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_value(data = UDA_scheduled_data,
                           historical_data = historical_UDA_scheduled_data,
                           payments_data = payments_to_dentists,
                           UDA_value_data = UDA_UOA_value_data,
                           protos = prototype_contracts$prototype_contract_number,
                           all_regions_and_STPs = FALSE,
                           asIndex = FALSE,
                                level = "Regional",
                                region_STP_name = "London",
                                plotChart = TRUE)
```


 ]
 .panel[.panel-name[Midlands]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_value(data = UDA_scheduled_data,
                           historical_data = historical_UDA_scheduled_data,
                           payments_data = payments_to_dentists,
                           UDA_value_data = UDA_UOA_value_data,
                           protos = prototype_contracts$prototype_contract_number,
                           all_regions_and_STPs = FALSE,
                           asIndex = FALSE,
                                level = "Regional",
                                region_STP_name = "Midlands",
                                plotChart = TRUE)
```



 ]
 .panel[.panel-name[East of England]
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot_cumulative_UDA_value(data = UDA_scheduled_data,
                           historical_data = historical_UDA_scheduled_data,
                           payments_data = payments_to_dentists,
                           UDA_value_data = UDA_UOA_value_data,
                           protos = prototype_contracts$prototype_contract_number,
                           all_regions_and_STPs = FALSE,
                           asIndex = FALSE,
                                level = "Regional",
                                region_STP_name = "East of England",
                                plotChart = TRUE)
```


 ] 
 .panel[.panel-name[Data]

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=6}

data <- plot_cumulative_UDA_value_all_regions()

data %>%
  download_this(
    output_name = "practice_closures_data",
    output_extension = ".xlsx",
    button_label = "Download data",
    button_type = "warning",
    has_icon = TRUE,
    icon = "fa fa-save"
  )
```

```{r echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
reactable(
  plot_cumulative_UDA_value_all_regions(),
  filterable = TRUE,
  paginateSubRows = TRUE,
  minRows = 5,
  highlight = TRUE,
  groupBy = c("Month", "Region Name"),
  columns = list(
    `Financial delivery (pounds)`= colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Financial delivery (million pounds)` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `Cumulative financial delivery (million pounds)` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE),
    `2017/18 - 2019/20 mean financial delivery (million pounds)` = colDef(aggregate = "sum", format = colFormat(digits = 0), filterable = FALSE)
)
)
```

 ]
 ]

[Return to contents](#contents)



---

name: my-cat-breakdown

### Appendix
#### MY Category classification breakdown:

 <font size="2">

* Cat 1
  + Details in CoMPASS Correct
* Cat 2
  + Carry Forward - Other
  + Flexibly Commissioned Contract
  + Force majeure accepted
  + Force majeure o/s
  + In-year incorporation/merge (Parent contract - letter will be sent)
  + Incomplete OOH/other access services
  + Late subs processed
  + Mixed / CoT Contract
  + Non-recurring activity
  + Open in-year
  + Other
  + Request to re-base
  + Review Carry Forward
  + Sub Contracts (Parent contract - letter will be sent)
  + UDA Value below Â£15.00
  + UDA Value exceeds Â£49.99
  + UDC
  + UOA Value exceeds Â£75.00
  + Closed in-year
  + Incomplete service line entries

---

 <font size="2">

* Cat 3
  + CDS
  + Closed in year
  + Contract End Date before 01/04/2020
  + Contract End Date before 01/04/2021
  + Contract End Date before 01/04/2022
  + DCO req to resolve locally
  + Domiciliary/ Sedation
  + IMOS/MOS
  + In-year incorporation/merge (Child contract - letter will not be sent)
  + Incomplete OOH/other access services
  + Known performance/contract issues
  + No Contracted activity
  + No Contracted value
  + Not paid by the NHSBSA
  + Open in year
  + Other
  + Other - Please state why
  + Other Advanced/Additional Services
  + PDS Plus
  + Prison
  + Sub Contracts (Child contract - letter will not be sent)
* Cat 4
  + Dental Contract Reform

---

name: data-sources

#### Data sources

 <font size="2">
* BSA calendar and scheduled UDA data downloaded from the "NHS England Central Dashboard" on eDEN. This data is downloaded monthly and put on the NCDR.
* Tables are:
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[UDA_calendar]
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[UDA_scheduled]
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[UOA_calendar]
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[UOA_scheduled]
* Historical data going back to April 2016 is saved here:
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[UDA_scheduled_historical]
* A list of prototype contracts are also available in:
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[prototype_contracts]
* Tables of UDA delivery on STP/ICB level in calendar and scheduled format available in:
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[UDA_delivery_calendar]
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[UDA_delivery_scheduled]

* 111 data comes from the pathways tool which is received monthly by email.
* Rolling unique patients data is received monthly by email from the BSA and saved on the NCDR in the following table:
  + [NHSE_Sandbox_PrimaryCareNHSContracts].[Dental].[unique_patients_rolling_12_month]
* CDS data is downloaded from the [CDS dashboard](https://miteam.shinyapps.io/CDS_Dashboard/)
* Payments to dentists data comes from the publicly available [BSA data](https://www.nhsbsa.nhs.uk/dental-data/nhs-payments-dentists)




<!--  ```{r xaringan-panelset-UDA-activity, echo=FALSE} -->
<!--  xaringanExtra::use_panelset() -->
<!--  ``` -->
<!--   <font size="2"> -->
<!--  .panelset[ -->

<!--  .panel[.panel-name[National] -->


<!--  ] -->
<!--  .panel[.panel-name[South East] -->



<!--  ] -->
<!--  .panel[.panel-name[South West] -->



<!--  ] -->
<!--  .panel[.panel-name[North West] -->



<!--  ] -->
<!--  .panel[.panel-name[North East and Yorkshire] -->



<!--  ] -->
<!-- .panel[.panel-name[London] -->


<!--  ] -->
<!--  .panel[.panel-name[Midlands] -->



<!--  ] -->
<!--  .panel[.panel-name[East of England] -->



<!--  ] -->
<!--  ] -->


<!-- --- -->






